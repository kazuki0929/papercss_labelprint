<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
        crossorigin="anonymous">
    <link href="app.css" rel="stylesheet" type="text/css" />
</head>

<body class="A4">
    <section class="sheet" >
        <table class="print">
            <tbody>
                <tr>
                    <td id="origin">
                        <img class="logo" alt="">
                        <p class="section" />
                        <div class="Name">
                            <div style="float:left; margin-right:5mm">
                                <p class="FirstKana" />
                                <p class="KanaSpan" />
                                <p class="FirstName" />
                            </div>
                            <div style="float:left">
                                <p class="LastKana" />
                                <p class="KanaSpan" />
                                <p class="LastName" />
                            </div>
                        </div>
                        <p class="address"/>
                    </td>
                    <td>
                    </td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                </tr>
            </tbody>
        </table>
    </section>
</body>
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script type="text/javascript">
    $(document).ready(function () {

        var parent = window.opener;

        // 取得したパラメータを左上セルに配置
        $(".logo").attr("src", "logo.png");
        $(".section").html((parent.$("#section").val()).replace(/\n/g, '<br>'));
        $(".FirstKana").html(parent.$("#FirstKana").val());
        $(".FirstName").html(parent.$("#FirstName").val());
        $(".LastKana").html(parent.$("#LastKana").val());
        $(".LastName").html(parent.$("#LastName").val());
        $(".address").html((parent.$("#address").val()).replace(/\n/g, '<br>'));

        // 所属の行数（１～３行）によってデザインが若干変化する
        var tmp = (parent.$("#section")).val().match(/\n/g);
        var cnt = tmp ? tmp.length : 0;
        if (cnt < 1) {
            $(".section").css("font-size", "8.5pt");
            $(".section").css("top", "14.6mm");
            $(".Name").css("top", "21.0mm");
        } else if (cnt == 1) {
            $(".section").css("font-size", "8.5pt");
            $(".section").css("top", "13.6mm");
            $(".Name").css("top", "22.0mm");
        } else if (cnt > 1) {
            $(".section").css("font-size", "8pt");
            $(".section").css("top", "12.9mm");
            $(".Name").css("top", "22.8mm");
        }

        // セルを全体にコピー
        $("td").html($("td#origin").html());
        // 印刷画面を自動的に表示。閉じると自動的にウィンドウも閉じる。
        setTimeout(function () {
             window.print();
             window.close();
        }, 200);
    })
</script>

</html>